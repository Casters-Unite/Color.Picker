<!DOCTYPE html>
<html>
<head>
<title>Color Picker</title>
<style>
body {
    font-family: sans-serif;
    color: #fff;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    box-sizing: border-box;
    background-color: #222;
}

.color-picker-container {
    background-color: #121212;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
    width: 100%;
    max-width: 600px;
    box-sizing: border-box;
}

.color-gradient {
    height: 150px;
    margin-bottom: 10px;
    position: relative;
    cursor: crosshair;
    overflow: hidden;
}

.color-gradient::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 1) 100%);
    pointer-events: none;
}

.color-selector {
    width: 100%;
    height: 15px;
    background: linear-gradient(to right, red, orange, yellow, green, blue, indigo, violet);
    margin-bottom: 10px;
    border: none;
    outline: none;
    appearance: none;
    -webkit-appearance: none;
    cursor: pointer;
}

.color-selector::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 20px;
    height: 20px;
    background-color: #fff;
    border: 2px solid #555;
    border-radius: 50%;
    cursor: pointer;
}

.alpha-slider-container {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
}

.alpha-slider-label {
    margin-right: 10px;
    font-size: 0.8em;
    white-space: nowrap;
}

#alphaSlider {
    width: 100%;
    height: 10px;
    appearance: none;
    -webkit-appearance: none;
    background: #555;
    outline: none;
    border-radius: 5px;
    cursor: pointer;
}

#alphaSlider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 15px;
    height: 15px;
    background: white;
    border: 2px solid #555;
    border-radius: 50%;
    cursor: pointer;
}



.color-preview-circle {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 20px;
    height: 20px;
    border-radius: 50%;
    border: 2px solid white;
    pointer-events: none;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
}


.color-info {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    margin-bottom: 10px;
}

.color-info div {
    width: 48%;
    padding: 5px;
    border: 1px solid #333;
    border-radius: 4px;
    font-size: 0.8em;
    text-align: center;
    box-sizing: border-box;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-bottom: 5px;
}

@media (max-width: 600px) {
    .color-info div {
        width: 100%;
    }
}



.hex-input-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background-color: #282828;
    border-radius: 4px;
    padding: 5px;
    margin-bottom: 10px;
}


#hex-color {
    background-color: transparent;
    border: none;
    color: white;
    outline: none;
    width: 70%;
}

.copy-hex {
    padding: 5px;
    cursor: pointer;
    background-color: #333;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.copy-hex:hover {
  background-color: #444;
}

.copy-hex svg {
    width: 20px;
    height: auto;
    display: block;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 20px;
  height: 20px;
  background: white;
  border: 1px solid #555;
  border-radius: 50%;
  margin-top: -8px;
  box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
}

input[type="range"]::-moz-range-thumb {
  width: 20px;
  height: 20px;
  background: white;
  border: 1px solid #555;
  border-radius: 50%;
  box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
}

#rgb-value, #cmyk-value, #hsv-value, #hsl-value {
  display: inline;
}

.copy-button {
    cursor: pointer;
    padding: 0;
    background-color: transparent;
    border: none;
    margin-left: 5px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
}

.copy-button:hover {
    background-color: #444;
    border-radius: 4px;
}

.copy-button svg {
    width: 100%;
    height: auto;
    display: block;
}


/* Added background pattern to visualize transparency */
.alpha-bg {
  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAACJjSFNxAAEAAAAIAAAIBwczAAAbAAAAEAAAABAAAAAQAAAAAAIAAAAAAAQCshAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAdBJREFUOBHtksENgzAQBPe8kQK8JbwmAQH1c4n1FwJHkGZBfAPgJ7wm9HyjVq1bZdxUTczUxMzU/h+f0gO88sD+4/F556gJkAK3yP4K1gG6ARUA7LILrAbgA0rAG5YBvQA0jAF1wJ5AAOQAN8DqgDqAOuA3oA6gDpwOwI6gJwB5ADiAHkAPIBwL444jWL4tCgAAAABJRU5ErkJggg==");
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: -1;
}

</style>
</head>
<body>

<div class="color-picker-container">
    <div class="color-gradient" id="colorGradient">
        <div class="alpha-bg"></div>
        <div class="color-preview-circle" id="colorPreview"></div>
    </div>
    <input type="range" class="color-selector" id="hueSlider" min="0" max="360" value="0">

    <div class="alpha-slider-container">
        <label for="alphaSlider" class="alpha-slider-label">Alpha:</label>
        <input type="range" id="alphaSlider" min="0" max="100" value="100">
    </div>

    <div class="hex-input-container">
        <input type="text" id="hex-color" value="#FF0000" readonly>
        <div class="copy-hex" onclick="copyHex()" id="hexCopyIcon"></div>
    </div>

    <div class="color-info">
        <div>
            <b>RGB</b>
            <div id="rgb-value"><span id="rgb-text">255, 0, 0</span><span class="copy-button" onclick="copyColor('rgb')"  id="rgbCopyIcon"></span></div>
        </div>
        <div>
            <b>CMYK</b>
            <div id="cmyk-value"><span id="cmyk-text">0%, 100%, 100%, 0%</span><span class="copy-button" onclick="copyColor('cmyk')" id="cmykCopyIcon"></span></div>
        </div>
        <div>
            <b>HSV</b>
            <div id="hsv-value"><span id="hsv-text">0°, 100%, 100%</span><span class="copy-button" onclick="copyColor('hsv')" id="hsvCopyIcon"></span></div>
        </div>
        <div>
            <b>HSL</b>
            <div id="hsl-value"><span id="hsl-text">0°, 100%, 50%</span><span class="copy-button" onclick="copyColor('hsl')" id="hslCopyIcon"></span></div>
        </div>
    </div>
</div>


<script>
  /**
   * Color Picker Component
   *
   * This script implements a dynamic color picker with HSV, RGB, CMYK, and HSL color models.
   * It allows users to select colors from a gradient, adjust alpha transparency, and copy color values to the clipboard.
   */

  // DOM element references
  const hueSlider = document.getElementById('hueSlider');
  const colorGradient = document.getElementById('colorGradient');
  const colorPreview = document.getElementById('colorPreview');
  const hexColorInput = document.getElementById('hex-color');
  const rgbValueDiv = document.getElementById('rgb-text');
  const cmykValueDiv = document.getElementById('cmyk-text');
  const hsvValueDiv = document.getElementById('hsv-text');
  const hslValueDiv = document.getElementById('hsl-text');
  const alphaSlider = document.getElementById('alphaSlider');

  // Copy icon DOM element references
  const hexCopyIcon = document.getElementById('hexCopyIcon');
  const rgbCopyIcon = document.getElementById('rgbCopyIcon');
  const cmykCopyIcon = document.getElementById('cmykCopyIcon');
  const hsvCopyIcon = document.getElementById('hsvCopyIcon');
  const hslCopyIcon = document.getElementById('hslCopyIcon');

  // Color variables
  let hue = 0;
  let saturation = 100;
  let value = 100;
  let isDragging = false;
  let alpha = 1;

  /**
   * SVG code for the copy icon.
   * @constant {string}
   */
  const copyIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M19 7c0-1.1-.9-2-2-2h-4c0-1.66-1.34-3-3-3S7 3.34 7 5H3c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h4c0 1.66 1.34 3 3 3s3-1.34 3-3h4c1.1 0 2-.9 2-2V7zM3 7h4v10H3V7zm11 12c0 .55-.45 1-1 1s-1-.45-1-1H9c0 .55-.45 1-1 1s-1-.45-1-1V5c0-.55.45-1 1-1s1 .45 1 1h4c0-.55.45-1 1-1s1 .45 1 1v14zm2-12H7V7h10v8H17V7z"/></svg>`;

  // Inject the SVG into the elements
  hexCopyIcon.innerHTML = copyIconSVG;
  rgbCopyIcon.innerHTML = copyIconSVG;
  cmykCopyIcon.innerHTML = copyIconSVG;
  hsvCopyIcon.innerHTML = copyIconSVG;
  hslCopyIcon.innerHTML = copyIconSVG;

  /**
   * Updates the URL by appending or modifying a query parameter.
   *
   * @param {string} uri - The base URI.
   * @param {string} key - The key of the query parameter.
   * @param {string} value - The value of the query parameter.
   * @returns {string} The updated URI.
   */
  function updateURLParameter(uri, key, value) {
      // Remove existing parameter
      let re = new RegExp("([?&])" + key + "=.*?(&|$)", "i");
      let separator = uri.indexOf('?') !== -1 ? "&" : "?";
      uri = uri.replace(re, '$1');  // Remove the existing parameter
      uri = uri.replace(/(&)$/, '');  // Remove trailing & if it exists

      // Add the new parameter
      if (value) {
          uri += separator + key + "=" + encodeURIComponent(value);
      }
      return uri;
  }

  /**
   * Copies the selected color to the clipboard and updates the URL.
   *
   * @param {string} colorFormat - The color format to copy ('hex', 'rgb', 'cmyk', 'hsv', 'hsl').
   */
  function copyColor(colorFormat) {
      let colorValue = "";

      switch (colorFormat) {
          case 'hex':
              colorValue = hexColorInput.value;
              break;
          case 'rgb':
              colorValue = rgbValueDiv.textContent;
              break;
          case 'cmyk':
              colorValue = cmykValueDiv.textContent;
              break;
          case 'hsv':
              colorValue = hsvValueDiv.textContent;
              break;
          case 'hsl':
              colorValue = hslValueDiv.textContent;
              break;
          default:
              console.error("Invalid color format specified for copyColor:", colorFormat);
              return;
      }

      navigator.clipboard.writeText(colorValue)
          .then(() => {
              // Update the URL and browser history
              const newURL = updateURLParameter(window.location.href, 'Color', colorValue);
              window.history.pushState({ path: newURL }, '', newURL);

              // Provide visual feedback (e.g., change the copy icon briefly)
              const copyButton = document.querySelector(`[onclick="copyColor('${colorFormat}')"]`);  // Select the correct button
              copyButton.textContent = 'Copied!';

              // Reset the copy icon after a short delay
              setTimeout(() => {
                  copyButton.textContent = '';
                  document.getElementById(`${colorFormat}CopyIcon`).innerHTML = copyIconSVG;
              }, 1500);
          })
          .catch(err => {
              console.error('Failed to copy color: ', err);
          });
  }

    /**
     * Copies the hex color to the clipboard and updates the URL.
     */
    function copyHex() {
      copyColor('hex'); //Call copyColor with 'hex' argument.
    }

  /**
   * Updates the color based on the current hue, saturation, value, and alpha.
   */
  function updateColor() {
      const h = hue;
      const s = saturation / 100;
      const v = value / 100;

      let r, g, b;

      const i = Math.floor(h / 60);
      const f = h / 60 - i;
      const p = v * (1 - s);
      const q = v * (1 - s * f);
      const t = v * (1 - s * (1 - f));

      switch (i % 6) {
          case 0: r = v; g = t; b = p; break;
          case 1: r = q; g = v; b = p; break;
          case 2: r = p; g = v; b = t; break;
          case 3: r = p; g = q; b = v; break;
          case 4: r = t; g = p; b = v; break;
          case 5: r = v; g = p; b = q; break;
      }

      const red = Math.round(r * 255);
      const green = Math.round(g * 255);
      const blue = Math.round(b * 255);

      const rgbColor = `rgba(${red}, ${green}, ${blue}, ${alpha.toFixed(2)})`;

      const gradientColor = `hsl(${hue}, 100%, 50%)`;
      colorGradient.style.background = `linear-gradient(to right, white, ${gradientColor})`;

      colorPreview.style.backgroundColor = rgbColor;

      const hexColor = rgbToHex(red, green, blue, alpha);
      hexColorInput.value = hexColor;

      // Update RGB with alpha
      rgbValueDiv.textContent = `rgba(${red}, ${green}, ${blue}, ${alpha.toFixed(2)})`;

      cmykValueDiv.textContent = calculateCMYK(red, green, blue);
      hsvValueDiv.textContent = calculateHSV(red, green, blue);
      hslValueDiv.textContent = calculateHSL(red, green, blue);
  }

  /**
   * Converts RGB values to a hex color code.
   *
   * @param {number} r - The red value (0-255).
   * @param {number} g - The green value (0-255).
   * @param {number} b - The blue value (0-255).
   * @param {number} a - The alpha value (0-1).
   * @returns {string} The hex color code (e.g., #RRGGBBAA).
   */
  function rgbToHex(r, g, b, a = 1) {
      r = Math.round(r);
      g = Math.round(g);
      b = Math.round(b);

      const hexR = r.toString(16).padStart(2, '0');
      const hexG = g.toString(16).padStart(2, '0');
      const hexB = b.toString(16).padStart(2, '0');
      const hexA = Math.round(a * 255).toString(16).padStart(2, '0');

      return `#${hexR}${hexG}${hexB}${hexA}`;
  }

  /**
   * Calculates CMYK values from RGB values.
   *
   * @param {number} r - The red value (0-255).
   * @param {number} g - The green value (0-255).
   * @param {number} b - The blue value (0-255).
   * @returns {string} The CMYK values (e.g., 0%, 100%, 100%, 0%).
   */
  function calculateCMYK(r, g, b) {
      r /= 255;
      g /= 255;
      b /= 255;

      const k = 1 - Math.max(r, g, b);
      const c = (1 - r - k) / (1 - k) || 0;
      const m = (1 - g - k) / (1 - k) || 0;
      const y = (1 - b - k) / (1 - k) || 0;

      return `${(c * 100).toFixed(0)}%, ${(m * 100).toFixed(0)}%, ${(y * 100).toFixed(0)}%, ${(k * 100).toFixed(0)}%`;
  }

  /**
   * Calculates HSV values from RGB values.
   *
   * @param {number} r - The red value (0-255).
   * @param {number} g - The green value (0-255).
   * @param {number} b - The blue value (0-255).
   * @returns {string} The HSV values (e.g., 0°, 100%, 100%).
   */
  function calculateHSV(r, g, b) {
      r /= 255;
      g /= 255;
      b /= 255;

      const max = Math.max(r, g, b);
      const min = Math.min(r, g, b);
      const delta = max - min;

      let h = 0;
      if (delta !== 0) {
          if (max === r) {
              h = 60 * (((g - b) / delta) % 6);
          } else if (max === g) {
              h = 60 * (((b - r) / delta) + 2);
          } else {
              h = 60 * (((r - g) / delta) + 4);
          }
      }

      const s = max === 0 ? 0 : delta / max;
      const v = max;

      return `${h.toFixed(0)}°, ${(s * 100).toFixed(0)}%, ${(v * 100).toFixed(0)}%`;
  }

  /**
   * Calculates HSL values from RGB values.
   *
   * @param {number} r - The red value (0-255).
   * @param {number} g - The green value (0-255).
   * @param {number} b - The blue value (0-255).
   * @returns {string} The HSL values (e.g., 0°, 100%, 50%).
   */
  function calculateHSL(r, g, b) {
      r /= 255;
      g /= 255;
      b /= 255;

      const max = Math.max(r, g, b);
      const min = Math.min(r, g, b);
      const delta = max - min;

      const l = (max + min) / 2;

      let h = 0;
      if (delta !== 0) {
          if (max === r) {
              h = 60 * (((g - b) / delta) % 6);
          } else if (max === g) {
              h = 60 * (((b - r) / delta) + 2);
          } else {
              h = 60 * (((r - g) / delta) + 4);
          }
      }

      const s = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1));

      return `${h.toFixed(0)}°, ${(s * 100).toFixed(0)}%, ${(l * 100).toFixed(0)}%`;
  }

  /**
   * Event listener for the hue slider.
   * Updates the hue value and triggers a color update.
   */
  hueSlider.addEventListener('input', (e) => {
      hue = parseInt(e.target.value);
      updateColor();
  });

  /**
   * Event listener for the alpha slider.
   * Updates the alpha value and triggers a color update.
   */
  alphaSlider.addEventListener('input', (e) => {
      alpha = parseInt(e.target.value) / 100;
      updateColor();
  });

  /**
   * Event listeners for dragging functionality on the color gradient.
   */
  colorGradient.addEventListener('mousedown', (e) => {
      isDragging = true;
      updateColorOnDrag(e);

      window.addEventListener('mousemove', handleMouseMove);
      window.addEventListener('mouseup', handleMouseUp);
  });

  /**
   * Handles mousemove events during dragging.
   * Updates the color based on the drag position.
   */
  function handleMouseMove(e) {
      if (isDragging) {
          updateColorOnDrag(e);
      }
  }

  /**
   * Handles mouseup events to stop dragging.
   */
  function handleMouseUp() {
      isDragging = false;
      window.removeEventListener('mousemove', handleMouseMove);
      window.removeEventListener('mouseup', handleMouseUp);
  }

  /**
   * Updates the color based on the mouse position during dragging.
   * @param {MouseEvent} e - The mouse event.
   */
  function updateColorOnDrag(e) {
      const gradientWidth = colorGradient.offsetWidth;
      const gradientHeight = colorGradient.offsetHeight;
      const rect = colorGradient.getBoundingClientRect();

      let x = e.clientX - rect.left;
      let y = e.clientY - rect.top;

      x = Math.max(0, Math.min(x, gradientWidth));
      y = Math.max(0, Math.min(y, gradientHeight));

      saturation = (x / gradientWidth) * 100;
      value = 100 - (y / gradientHeight) * 100;

      colorPreview.style.left = `${x}px`;
      colorPreview.style.top = `${y}px`;
      colorPreview.style.transform = "translate(-50%, -50%)";

      updateColor();
  }

  // Initial color update
  updateColor();

</script>

</body>
</html>